<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å®š/é”€è´§å•</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 0.4in 0.3in 0.2in 0.3in !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            
            body {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
        
        body {
            font-family: "SimSun", "å®‹ä½“", serif;
            margin: 10px;
            line-height: 1.3;
            color: #000;
            font-size: 12px;
        }
        
        .action-buttons {
            margin: 20px 0;
            text-align: center;
            gap: 15px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            color: white;
        }
        
        .btn-save {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .btn-new {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        }
        
        .btn-print {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
        }
        
        .btn-export {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        
        .btn-image {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 12px;
            background: #f8f9fa;
            color: #000000;
            padding: 10px;
            border: 1px solid #000000;
            border-radius: 6px;
            position: relative;
        }
        
        .document-type-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
        }
        
        .header h1 {
            font-family: "Microsoft YaHei", "é»‘ä½“", "SimHei", sans-serif;
            font-size: 28px;
            font-weight: 900;
            margin: 0;
            color: #000000;
            letter-spacing: 2px;
            display: inline-block;
        }
        
        .document-type-display {
            cursor: pointer;
            font-size: 24px;
            font-weight: bold;
            color: #000000;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .dropdown-arrow {
            display: none;
        }
        
        .document-type-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 2px solid #000000;
            border-radius: 5px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 120px;
            display: none;
        }
        
        .dropdown-option {
            padding: 10px 15px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }
        
        .dropdown-option:hover {
            background-color: #f8f9fa;
        }
        
        .header .order-number {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            background: rgba(0,0,0,0.1);
            padding: 8px 15px;
            border-radius: 5px;
        }
        
        .order-number input {
            background: transparent;
            border: none;
            color: #000000;
            font-size: 16px;
            width: 200px;
            outline: none;
            border-bottom: 2px solid rgba(0,0,0,0.5);
            padding: 5px;
        }
        
        .notice {
            font-size: 12px;
            margin-bottom: 10px;
            padding: 8px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333;
            border-radius: 4px;
            border-left: 3px solid #6c757d;
        }
        
        .notice strong {
            font-size: 16px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        td, th {
            border: 1px solid #333;
            padding: 6px;
            text-align: left;
            vertical-align: middle;
        }
        
        .info-table td {
            height: 28px;
            font-size: 12px;
        }
        
        .info-table td:first-child {
            background-color: #e9ecef;
            color: #000000;
            font-weight: bold;
            text-align: center;
            border: 1px solid #000000;
        }
        
        .product-table th {
            background: #d6d8db;
            color: #000000;
            text-align: center;
            font-family: "Microsoft YaHei", "é»‘ä½“", "SimHei", sans-serif;
            font-weight: 900;
            font-size: 14px;
            padding: 12px 8px;
            border: 2px solid #000000;
            letter-spacing: 1px;
        }
        
        .product-table td {
            height: 24px;
            font-size: 12px;
        }
        
        .product-table tfoot td {
            background-color: #d6d8db;
            color: #000000;
            font-weight: bold;
            border: 1px solid #000000;
        }
        
        .payment-section {
            margin-top: 8px;
        }
        
        .payment-table td {
            height: 26px;
            font-size: 12px;
        }
        
        .payment-table td:first-child {
            background-color: #f8f9fa;
            font-weight: bold;
            text-align: center;
        }
        
        .terms {
            margin-top: 10px;
            font-size: 12px;
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid #6c757d;
        }
        
        .signature-section {
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .signature-box {
            flex: 1;
            text-align: center;
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .signature-line {
            height: 30px;
            border-bottom: 2px solid #333;
            margin: 8px 0;
        }
        
        .signature-stamp {
            height: 30px;
            border: 2px solid #333;
            margin: 8px 0;
            border-radius: 3px;
        }
        
        .agreement {
            font-size: 11px;
            margin-top: 8px;
            padding: 8px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 4px;
            border-left: 3px solid #6c757d;
        }
        
        .input-field {
            width: 100%;
            border: none;
            outline: none;
            background: transparent;
            font-family: inherit;
            font-size: inherit;
            padding: 2px;
        }
        
        .delivery-container {
            height: 100%;
            display: flex;
        }
        
        .delivery-label {
            width: 40%;
            background-color: #f8f9fa;
            font-weight: bold;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #333;
        }
        
        .delivery-input {
            width: 60%;
            padding: 12px;
            display: flex;
            align-items: center;
        }
        
        .amount-container {
            display: flex;
            height: 100%;
        }
        
        .amount-chinese {
            width: 65%;
            padding: 8px 12px;
            border-right: 1px solid #333;
            display: flex;
            align-items: center;
        }
        
        .amount-number {
            width: 35%;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        @media print {
            @page {
                size: A4;
                margin: 0.4in 0.3in 0.2in 0.3in;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            
            .action-buttons {
                display: none !important;
            }
            
            body {
                margin: 0;
                padding: 0;
                background: white;
                font-size: 10px;
                line-height: 1.1;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
                page-break-inside: avoid;
            }
            
            .header {
                background: #ffffff !important;
                color: #000000 !important;
                padding: 8px !important;
                margin-bottom: 6px !important;
                border: 1px solid #000000 !important;
                page-break-inside: avoid;
                position: relative;
            }
            
            .header .order-number {
                position: absolute !important;
                right: 15px !important;
                top: 50% !important;
                transform: translateY(-50%) !important;
                font-size: 12px !important;
                background: rgba(0,0,0,0.1) !important;
                padding: 4px 8px !important;
                border-radius: 3px !important;
            }
            
            .order-number input {
                width: 150px !important;
                font-size: 12px !important;
                padding: 2px !important;
            }
            
            .document-type-wrapper {
                margin-right: 180px !important;
            }
            
            .notice {
                font-size: 10px !important;
                margin-bottom: 6px !important;
                padding: 6px !important;
                page-break-inside: avoid;
            }
            
            table {
                margin-bottom: 6px !important;
                page-break-inside: avoid;
            }
            
            .info-table td {
                height: 22px !important;
                font-size: 10px !important;
                padding: 4px !important;
            }
            
            .product-table th {
                background: #d6d8db !important;
                color: #000000 !important;
                padding: 8px 4px !important;
                font-size: 11px !important;
                border: 2px solid #000000 !important;
                font-weight: 900 !important;
            }
            
            .product-table td {
                height: 20px !important;
                font-size: 10px !important;
                padding: 3px !important;
            }
            
            .product-table tfoot td {
                background-color: #d6d8db !important;
                color: #000000 !important;
                font-weight: bold !important;
                border: 1px solid #000000 !important;
                padding: 6px !important;
            }
            
            .payment-table td {
                height: 20px !important;
                font-size: 10px !important;
                padding: 4px !important;
            }
            
            .terms {
                font-size: 10px !important;
                margin-top: 6px !important;
                padding: 6px !important;
            }
            
            .signature-section {
                margin-top: 6px !important;
            }
            
            .signature-box {
                padding: 6px !important;
                font-size: 10px !important;
            }
            
            .agreement {
                font-size: 9px !important;
                margin-top: 6px !important;
                padding: 6px !important;
            }
            
            .amount-container {
                height: auto !important;
            }
            
            .amount-chinese, .amount-number {
                padding: 4px 8px !important;
            }
        }
        
        @media screen and (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
                padding: 14px 20px;
            }
            
            .header .order-number {
                position: static;
                transform: none;
                text-align: center;
                margin-top: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="action-buttons">
        <button class="btn btn-save" onclick="saveOrder()">ğŸ’¾ ä¿å­˜è®¢å•</button>
        <button class="btn btn-new" onclick="createNewOrder()">â• ä¿å­˜å¹¶æ–°å»º</button>
        <button class="btn btn-print" onclick="printForm()">ğŸ–¨ï¸ æ‰“å°è¡¨å•</button>
        <button class="btn btn-export" onclick="exportToPDF()">ğŸ“„ å¯¼å‡ºPDF</button>
        <button class="btn btn-image" onclick="exportToImage()">ğŸ–¼ï¸ å¯¼å‡ºå›¾ç‰‡</button>
    </div>

    <div class="header">
        <div class="document-type-wrapper">
            <h1>å®š/é”€è´§å•</h1>
            <span class="document-type-display" onclick="toggleDocTypeDropdown()">
                <span class="doc-type-text">ï¼ˆé¢„ç®—ï¼‰</span><span class="dropdown-arrow">â–¼</span>
            </span>
            <div class="document-type-dropdown" id="docTypeDropdown">
                <div class="dropdown-option" onclick="selectDocType('é¢„ç®—')">ï¼ˆé¢„ç®—ï¼‰</div>
                <div class="dropdown-option" onclick="selectDocType('ç»“ç®—')">ï¼ˆç»“ç®—ï¼‰</div>
            </div>
        </div>
        <div class="order-number">
            å•å·No.ï¼š<input type="text" placeholder="è¯·è¾“å…¥å•å·" id="orderNumber">
        </div>
    </div>
    
    <div class="notice">
        <strong>æ¸©é¦¨æç¤ºï¼š</strong>ä¸ºäº†è´­è´§æ–¹çš„åˆæ³•æƒç›Šç‰¹åˆ¶è®¢æ­¤æ”¿ç­–ï¼Œè¯·è¯¦ç»†é˜…è¯»æœ¬å•æ®è´­ç‰©é¡»çŸ¥ï¼Œå¹¶ç¡®è®¤å•æ®å†…å„é¡¹è´­ç‰©å†…å®¹ã€‚ä¸€ç»ç­¾å­—ç¡®è®¤ï¼Œå°†è§†åŒè´­è´§æ–¹å¯¹æœ¬å•æ®æ‰€æœ‰å†…å®¹å‡è¡¨ç¤ºåŒæ„ã€‚
    </div>
    
    <table class="info-table">
        <tr>
            <td style="width: 15%;">è´­è´§æ–¹</td>
            <td style="width: 35%;"><input type="text" class="input-field" id="buyer"></td>
            <td style="width: 15%;">è´­è´§æ–¹è”ç³»äºº/ç”µè¯</td>
            <td style="width: 35%;"><input type="text" class="input-field" id="buyerContact"></td>
        </tr>
        <tr>
            <td>ä¾›è´§æ–¹</td>
            <td><input type="text" class="input-field" value="å¦é—¨æ±‡ä»•ç¯ä¿ç§‘æŠ€æœ‰é™å…¬å¸" id="supplier"></td>
            <td>ä¾›è´§æ–¹ç”µè¯</td>
            <td><input type="text" class="input-field" value="0592-5772750" id="supplierPhone"></td>
        </tr>
        <tr>
            <td>ä¾›è´§æ–¹åœ°å€</td>
            <td colspan="2"><input type="text" class="input-field" value="å¦é—¨å¸‚æ¹–é‡ŒåŒºé’Ÿå®…çº¢æ˜Ÿç¾å‡¯é¾™E8038" id="supplierAddress"></td>
            <td rowspan="2" style="padding: 0;">
                <div class="delivery-container">
                    <div class="delivery-label">é€è´§æ–¹å¼</div>
                    <div class="delivery-input">
                        <input type="text" class="input-field" list="deliveryList" id="deliveryMethod">
                    </div>
                </div>
            </td>
        </tr>
        <tr>
            <td>æ”¶è´§æ–¹åœ°å€</td>
            <td colspan="2"><input type="text" class="input-field" id="receiverAddress"></td>
        </tr>
        <tr>
            <td>è®¢è´§æ—¥æœŸ</td>
            <td><input type="date" class="input-field" id="orderDate"></td>
            <td>é€è´§æ—¶é—´</td>
            <td><input type="date" class="input-field" id="deliveryDate"></td>
        </tr>
    </table>
    
    <table class="product-table">
        <thead>
            <tr>
                <th style="width: 22%;">å•†å“åç§°(å“ç‰Œ+åç§°)</th>
                <th style="width: 10%;">å‹å·</th>
                <th style="width: 10%;">è§„æ ¼</th>
                <th style="width: 10%;">é›¶å”®ä»·</th>
                <th style="width: 8%;">æ•°é‡</th>
                <th style="width: 8%;">å•ä½</th>
                <th style="width: 12%;">åˆä»·</th>
            </tr>
        </thead>
        <tbody>
            <tr><td><input type="text" class="input-field" list="productList" value="TECH Xéš”çƒ­è†œ" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" value="æ™¨æ›¦" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field" value="1.52m*30m"></td><td><input type="number" class="input-field" step="0.01" value="799" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
            <tr><td><input type="text" class="input-field" list="productList" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field"></td><td><input type="number" class="input-field" step="0.01" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
            <tr><td><input type="text" class="input-field" list="productList" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field"></td><td><input type="number" class="input-field" step="0.01" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
            <tr><td><input type="text" class="input-field" list="productList" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field"></td><td><input type="number" class="input-field" step="0.01" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
            <tr><td><input type="text" class="input-field" list="productList" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field"></td><td><input type="number" class="input-field" step="0.01" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
            <tr><td><input type="text" class="input-field" list="productList" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field"></td><td><input type="number" class="input-field" step="0.01" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
            <tr><td><input type="text" class="input-field" list="productList" onchange="updateProductPrice(this)"></td><td><input type="text" class="input-field" list="modelList" onchange="updateModelPrice(this)"></td><td><input type="text" class="input-field"></td><td><input type="number" class="input-field" step="0.01" onchange="calculateRow(this)"></td><td><input type="number" class="input-field" onchange="calculateRow(this)"></td><td><input type="text" class="input-field" placeholder="ã¡"></td><td><input type="number" class="input-field" step="0.01" readonly></td></tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="6" style="text-align: right; padding-right: 10px;">åˆè®¡ï¼š</td>
                <td><input type="number" id="totalAmount" class="input-field" step="0.01" readonly style="font-weight: bold;"></td>
            </tr>
        </tfoot>
    </table>
    
    <table>
        <tr>
            <td style="width: 15%; text-align: center; font-weight: bold; background-color: #f8f9fa;">å¤‡æ³¨</td>
            <td style="height: 50px;"><input type="text" class="input-field" value="è´¨ä¿æœŸäº”å¹´ï¼Œä»å®‰è£…ç»“æŸä¹‹æ—¥èµ·ç®—ï¼›è´¨ä¿æœŸå†…éäººä¸ºå’Œè‡ªç„¶ç¾å®³åŸå› å¼•èµ·çš„è´¨é‡é—®é¢˜ã€å®‰è£…é—®é¢˜ï¼Œç”±ä¾›è´§æ–¹è´Ÿè´£ç»´ä¿" id="remarks"></td>
        </tr>
    </table>
    
    <div class="payment-section">
        <table class="payment-table">
            <tr>
                <td style="width: 15%;">ä»˜æ¬¾æ–¹å¼</td>
                <td style="width: 85%;"><input type="text" class="input-field" list="paymentList" id="paymentMethod"></td>
            </tr>
            <tr>
                <td>æ”¶æ¬¾è´¦æˆ·</td>
                <td>è´¦å·ï¼š<input type="text" class="input-field" style="width: 20%; display: inline-block;" value="6226 1529 0065 3167"> æˆ·åï¼š<input type="text" class="input-field" style="width: 15%; display: inline-block;" value="é¥¶ç‰ç"> å¼€æˆ·è¡Œï¼š<input type="text" class="input-field" style="width: 50%; display: inline-block;" value="ä¸­å›½æ°‘ç”Ÿé“¶è¡Œ"></td>
            </tr>
            <tr>
                <td>å®å”®é‡‘é¢</td>
                <td style="padding: 0;">
                    <div class="amount-container">
                        <div class="amount-chinese">
                            <input type="text" class="input-field" placeholder="å¤§å†™é‡‘é¢" id="totalAmountChinese">
                        </div>
                        <div class="amount-number">
                            å°å†™(Â¥) <input type="number" class="input-field" style="width: 60%;" step="0.01" id="totalAmountNumber" onchange="updateChinese(this)">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td id="paymentLabel">æœ¬æ¬¡ä»˜æ¬¾é‡‘é¢</td>
                <td style="padding: 0;">
                    <div class="amount-container">
                        <div class="amount-chinese">
                            <input type="text" class="input-field" placeholder="å¤§å†™é‡‘é¢" id="currentPaymentChinese">
                        </div>
                        <div class="amount-number">
                            å°å†™(Â¥) <input type="number" class="input-field" style="width: 60%;" step="0.01" id="currentPaymentNumber" onchange="updateChinese(this); calculateBalance();">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>è´§æ¬¾ä½™é¢</td>
                <td style="padding: 0;">
                    <div class="amount-container">
                        <div class="amount-chinese">
                            <input type="text" class="input-field" placeholder="å¤§å†™é‡‘é¢" id="balanceChinese">
                        </div>
                        <div class="amount-number">
                            å°å†™(Â¥) <input type="number" class="input-field" style="width: 60%;" step="0.01" id="balanceNumber" readonly>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    
    <div class="terms">
        <strong>å…¶ä»–çº¦å®šï¼š</strong><br>
        1. è´§æ¬¾ä½™é¢åº”ç”±è´­è´§æ–¹åœ¨<input type="text" class="input-field" style="width: 200px; border-bottom: 1px solid #000; display: inline-block;">ä»˜æ¸…ã€‚<br>
        2. æœ¬å•å®å”®åˆè®¡é‡‘é¢ä¸­å·²åŒ…å«ä¸Šé—¨æ£€æµ‹ã€æµ‹é‡ã€è®¾è®¡ã€å‡ºå›¾ç­‰ç›¸å…³è´¹ç”¨ã€‚
    </div>
    
    <div class="signature-section">
        <div class="signature-box">
            <div>ä¾›è´§æ–¹ç­¾å­—ï¼š</div>
            <div class="signature-line"></div>
        </div>
        <div class="signature-box">
            <div>å”®åæœåŠ¡ç« ï¼š</div>
            <div class="signature-stamp"></div>
        </div>
        <div class="signature-box">
            <div>è´­è´§æ–¹ç­¾å­—ï¼š</div>
            <div class="signature-line"></div>
        </div>
    </div>
    
    <div class="agreement">
        <strong>è´­é”€çº¦å®šï¼š</strong>1. å¦‚æœå·²ä»˜é‡‘é¢å°äºåˆè®¡é‡‘é¢çš„30%ï¼Œåˆ™ä»¥å·²ä»˜é‡‘é¢åšä¸ºäº¤æ˜“å®šé‡‘ï¼›å¦‚æœå·²ä»˜é‡‘é¢å¤§äºç­‰äºåˆè®¡é‡‘é¢çš„30%ï¼Œåˆ™ä»¥åˆè®¡é‡‘é¢çš„30%åšä¸ºå®šé‡‘ã€‚2. è´­è´§æ–¹è¿çº¦é€€è´§çš„ï¼Œæ— æƒè¦æ±‚è¿”å›å®šé‡‘ï¼›ä¾›è´§æ–¹ä¸èƒ½äº¤è´§çš„ï¼Œåˆ™åº”è¿”è¿˜å®šé‡‘ã€‚
    </div>

    <datalist id="productList">
        <option value="TECH Xéš”çƒ­è†œ">
        <option value="éš”çƒ­è†œå®‰è£…è´¹">
    </datalist>
    <datalist id="modelList">
        <option value="æ™¨æ›¦">
        <option value="æš®è¯­">
        <option value="æ™ºå¹•Pro70">
        <option value="æ™ºå¹•Pro30">
    </datalist>
    <datalist id="paymentList">
        <option value="å¯¹ç§è½¬è´¦">
        <option value="å¯¹å…¬è½¬è´¦">
        <option value="å¾®ä¿¡è½¬è´¦">
        <option value="ç°é‡‘äº¤ä»˜">
    </datalist>
    <datalist id="deliveryList">
        <option value="é€è´§ä¸Šé—¨">
        <option value="è‡ªæ">
    </datalist>

    <script>
        // äº§å“ä»·æ ¼æ˜ å°„è¡¨
        const productPrices = {
            'æ™¨æ›¦': 799,
            'æš®è¯­': 799,
            'æ™ºå¹•Pro70': 1380,
            'æ™ºå¹•Pro30': 1380
        };

        // äººæ°‘å¸å¤§å†™è½¬æ¢å‡½æ•°
        function numberToChinese(num) {
            if (num === 0 || num === '' || isNaN(num)) return '';
            
            const digits = ['é›¶', 'å£¹', 'è´°', 'å', 'è‚†', 'ä¼', 'é™†', 'æŸ’', 'æŒ', 'ç–'];
            const units = ['', 'æ‹¾', 'ä½°', 'ä»Ÿ'];
            const bigUnits = ['', 'ä¸‡', 'äº¿'];
            
            let numStr = parseFloat(num).toFixed(2);
            let [integerPart, decimalPart] = numStr.split('.');
            
            let result = '';
            if (integerPart === '0') {
                result = 'é›¶';
            } else {
                let intNum = parseInt(integerPart);
                let groups = [];
                
                while (intNum > 0) {
                    groups.push(intNum % 10000);
                    intNum = Math.floor(intNum / 10000);
                }
                
                for (let i = groups.length - 1; i >= 0; i--) {
                    let group = groups[i];
                    if (group === 0) {
                        if (i > 0 && result !== '') result += 'é›¶';
                        continue;
                    }
                    
                    let groupStr = '';
                    let tempGroup = group;
                    let unitIndex = 0;
                    let hasZero = false;
                    
                    while (tempGroup > 0) {
                        let digit = tempGroup % 10;
                        if (digit === 0) {
                            if (!hasZero && groupStr !== '') {
                                groupStr = 'é›¶' + groupStr;
                                hasZero = true;
                            }
                        } else {
                            groupStr = digits[digit] + units[unitIndex] + groupStr;
                            hasZero = false;
                        }
                        tempGroup = Math.floor(tempGroup / 10);
                        unitIndex++;
                    }
                    
                    if (groupStr.startsWith('é›¶')) {
                        groupStr = groupStr.substring(1);
                    }
                    
                    result += groupStr + bigUnits[i];
                }
            }
            
            result += 'å…ƒ';
            
            if (decimalPart && decimalPart !== '00') {
                let jiao = parseInt(decimalPart[0]);
                let fen = parseInt(decimalPart[1]);
                
                if (jiao > 0) {
                    result += digits[jiao] + 'è§’';
                }
                if (fen > 0) {
                    if (jiao === 0 && result.endsWith('å…ƒ')) {
                        result += 'é›¶';
                    }
                    result += digits[fen] + 'åˆ†';
                }
            } else {
                result += 'æ•´';
            }
            
            return result;
        }

        // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 6px;
                color: white;
                font-size: 14px;
                z-index: 10000;
                opacity: 0;
                transition: all 0.3s ease;
                ${type === 'success' ? 'background: #28a745;' : ''}
                ${type === 'error' ? 'background: #dc3545;' : ''}
                ${type === 'info' ? 'background: #17a2b8;' : ''}
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => toast.style.opacity = '1', 100);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => {
                    if (toast.parentNode) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // æ›´æ–°äº§å“ä»·æ ¼ï¼ˆæ ¹æ®å•†å“åç§°ï¼‰
        function updateProductPrice(input) {
            // è¿™ä¸ªå‡½æ•°æš‚æ—¶ä¸åšå¤„ç†ï¼Œä¸»è¦é€šè¿‡å‹å·æ¥æ›´æ–°ä»·æ ¼
        }

        // æ›´æ–°å‹å·ä»·æ ¼ï¼ˆæ ¹æ®å‹å·ï¼‰
        function updateModelPrice(input) {
            const modelValue = input.value.trim();
            const row = input.closest('tr');
            const priceInput = row.querySelector('td:nth-child(4) input');
            
            if (productPrices[modelValue]) {
                priceInput.value = productPrices[modelValue];
                calculateRow(priceInput);
                showToast(`å·²è‡ªåŠ¨è®¾ç½®${modelValue}çš„ä»·æ ¼ï¼šÂ¥${productPrices[modelValue]}`, 'info');
            }
        }

        // è®¡ç®—è¡Œæ€»é¢
        function calculateRow(input) {
            const row = input.closest('tr');
            const cells = row.querySelectorAll('td');
            const priceInput = cells[3].querySelector('input');
            const quantityInput = cells[4].querySelector('input');
            const totalInput = cells[6].querySelector('input');
            
            const price = parseFloat(priceInput.value) || 0;
            const quantity = parseFloat(quantityInput.value) || 0;
            const total = price * quantity;
            
            totalInput.value = total.toFixed(2);
            calculateGrandTotal();
        }

        // è®¡ç®—æ€»è®¡
        function calculateGrandTotal() {
            const totalInputs = document.querySelectorAll('.product-table tbody tr td:last-child input');
            let grandTotal = 0;
            
            totalInputs.forEach(input => {
                grandTotal += parseFloat(input.value) || 0;
            });
            
            document.getElementById('totalAmount').value = grandTotal.toFixed(2);
            document.getElementById('totalAmountNumber').value = grandTotal.toFixed(2);
            updateChinese(document.getElementById('totalAmountNumber'));
            calculateBalance();
        }

        // æ›´æ–°ä¸­æ–‡å¤§å†™
        function updateChinese(input) {
            const value = parseFloat(input.value) || 0;
            const chineseValue = numberToChinese(value);
            
            if (input.id === 'totalAmountNumber') {
                document.getElementById('totalAmountChinese').value = chineseValue;
            } else if (input.id === 'currentPaymentNumber') {
                document.getElementById('currentPaymentChinese').value = chineseValue;
            }
        }

        // è®¡ç®—ä½™é¢
        function calculateBalance() {
            const total = parseFloat(document.getElementById('totalAmountNumber').value) || 0;
            const payment = parseFloat(document.getElementById('currentPaymentNumber').value) || 0;
            const balance = total - payment;
            
            document.getElementById('balanceNumber').value = balance.toFixed(2);
            document.getElementById('balanceChinese').value = numberToChinese(balance);
        }

        // æŒ‰é’®åŠŸèƒ½
        function saveOrder() {
            try {
                const data = {};
                document.querySelectorAll('input').forEach(input => {
                    if (input.id) {
                        data[input.id] = input.value;
                    }
                });
                
                localStorage.setItem('purchaseOrderData', JSON.stringify(data));
                showToast('è®¢å•ä¿å­˜æˆåŠŸï¼', 'success');
            } catch (error) {
                console.error('ä¿å­˜å¤±è´¥:', error);
                showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        function createNewOrder() {
            try {
                saveOrder();
                
                // æ¸…ç©ºè¡¨å•ï¼ˆä¿ç•™ä¾›è´§æ–¹ä¿¡æ¯ï¼‰
                document.querySelectorAll('.input-field').forEach(input => {
                    if (input.value !== 'å¦é—¨æ±‡ä»•ç¯ä¿ç§‘æŠ€æœ‰é™å…¬å¸' && 
                        input.value !== '0592-5772750' && 
                        input.value !== 'å¦é—¨å¸‚æ¹–é‡ŒåŒºé’Ÿå®…çº¢æ˜Ÿç¾å‡¯é¾™E8038' &&
                        input.value !== 'è´¨ä¿æœŸäº”å¹´ï¼Œä»å®‰è£…ç»“æŸä¹‹æ—¥èµ·ç®—ï¼›è´¨ä¿æœŸå†…éäººä¸ºå’Œè‡ªç„¶ç¾å®³åŸå› å¼•èµ·çš„è´¨é‡é—®é¢˜ã€å®‰è£…é—®é¢˜ï¼Œç”±ä¾›è´§æ–¹è´Ÿè´£ç»´ä¿' &&
                        input.value !== '6226 1529 0065 3167' &&
                        input.value !== 'é¥¶ç‰ç' &&
                        input.value !== 'ä¸­å›½æ°‘ç”Ÿé“¶è¡Œ') {
                        input.value = '';
                    }
                });
                
                // ç”Ÿæˆæ–°è®¢å•å·
                const now = new Date();
                const orderNumber = 'PO' + now.getFullYear() + 
                                  String(now.getMonth() + 1).padStart(2, '0') + 
                                  String(now.getDate()).padStart(2, '0') + 
                                  String(now.getHours()).padStart(2, '0') + 
                                  String(now.getMinutes()).padStart(2, '0');
                document.getElementById('orderNumber').value = orderNumber;
                
                // è®¾ç½®ä»Šå¤©æ—¥æœŸ
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('orderDate').value = today;
                document.getElementById('deliveryDate').value = today;
                
                // é‡æ–°è®¾ç½®ç¬¬ä¸€è¡Œé¢„ç½®æ•°æ®
                const firstRow = document.querySelector('.product-table tbody tr:first-child');
                if (firstRow) {
                    const inputs = firstRow.querySelectorAll('input');
                    if (inputs[0]) inputs[0].value = 'TECH Xéš”çƒ­è†œ';
                    if (inputs[1]) inputs[1].value = 'æ™¨æ›¦';
                    if (inputs[2]) inputs[2].value = '1.52m*30m';
                    if (inputs[3]) inputs[3].value = '799';
                }
                
                showToast('æ–°è®¢å•åˆ›å»ºæˆåŠŸï¼', 'success');
            } catch (error) {
                console.error('åˆ›å»ºæ–°è®¢å•å¤±è´¥:', error);
                showToast('åˆ›å»ºæ–°è®¢å•å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        function printForm() {
            try {
                window.print();
                showToast('æ­£åœ¨æ‰“å°...', 'info');
            } catch (error) {
                console.error('æ‰“å°å¤±è´¥:', error);
                showToast('æ‰“å°å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        function exportToPDF() {
            try {
                showToast('è¯·åœ¨æ‰“å°å¯¹è¯æ¡†ä¸­é€‰æ‹©"ä¿å­˜ä¸ºPDF"', 'info');
                setTimeout(() => {
                    window.print();
                }, 1000);
            } catch (error) {
                console.error('å¯¼å‡ºPDFå¤±è´¥:', error);
                showToast('å¯¼å‡ºPDFå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        function exportToImage() {
            try {
                showToast('å›¾ç‰‡å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­ï¼Œè¯·ä½¿ç”¨æ‰“å°åŠŸèƒ½', 'info');
            } catch (error) {
                console.error('å¯¼å‡ºå›¾ç‰‡å¤±è´¥:', error);
                showToast('å¯¼å‡ºå›¾ç‰‡å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æ–‡æ¡£ç±»å‹åˆ‡æ¢åŠŸèƒ½
        function toggleDocTypeDropdown() {
            const dropdown = document.getElementById('docTypeDropdown');
            const arrow = document.querySelector('.dropdown-arrow');
            
            if (dropdown.style.display === 'block') {
                dropdown.style.display = 'none';
                if (arrow) arrow.style.transform = 'rotate(0deg)';
            } else {
                dropdown.style.display = 'block';
                if (arrow) arrow.style.transform = 'rotate(180deg)';
            }
        }
        
        function selectDocType(type) {
            // ä¿å­˜å½“å‰æ•°æ®ï¼ˆé™¤äº†å•å·ï¼‰
            const currentData = {};
            document.querySelectorAll('input').forEach(input => {
                if (input.id && input.id !== 'orderNumber') {
                    currentData[input.id] = input.value;
                }
            });
            
            // æ›´æ–°æ–‡æ¡£ç±»å‹æ˜¾ç¤º
            document.querySelector('.doc-type-text').textContent = `ï¼ˆ${type}ï¼‰`;
            document.getElementById('docTypeDropdown').style.display = 'none';
            const arrow = document.querySelector('.dropdown-arrow');
            if (arrow) arrow.style.transform = 'rotate(0deg)';
            
            // æ›´æ–°å•å·å’Œä»˜æ¬¾æ ‡ç­¾
            const orderNumberInput = document.getElementById('orderNumber');
            const paymentLabel = document.getElementById('paymentLabel');
            
            if (type === 'ç»“ç®—') {
                // åœ¨å•å·åæ·»åŠ ï¼ˆç»“ï¼‰
                if (orderNumberInput && orderNumberInput.value && !orderNumberInput.value.includes('ï¼ˆç»“ï¼‰')) {
                    orderNumberInput.value += 'ï¼ˆç»“ï¼‰';
                }
                // æ›´æ”¹ä»˜æ¬¾æ ‡ç­¾
                if (paymentLabel) {
                    paymentLabel.textContent = 'å·²ä»˜æ¬¾é‡‘é¢';
                }
            } else {
                // ç§»é™¤å•å·ä¸­çš„ï¼ˆç»“ï¼‰
                if (orderNumberInput && orderNumberInput.value) {
                    orderNumberInput.value = orderNumberInput.value.replace('ï¼ˆç»“ï¼‰', '');
                }
                // æ¢å¤ä»˜æ¬¾æ ‡ç­¾
                if (paymentLabel) {
                    paymentLabel.textContent = 'æœ¬æ¬¡ä»˜æ¬¾é‡‘é¢';
                }
            }
            
            // æ¢å¤æ‰€æœ‰æ•°æ®ï¼ˆä¸åŒ…æ‹¬å•å·ï¼‰
            Object.keys(currentData).forEach(key => {
                const input = document.getElementById(key);
                if (input) {
                    input.value = currentData[key];
                }
            });
            
            showToast(`å·²åˆ‡æ¢ä¸º${type}æ¨¡å¼`, 'info');
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®é»˜è®¤æ—¥æœŸ
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('orderDate').value = today;
            document.getElementById('deliveryDate').value = today;
            
            // ç”Ÿæˆé»˜è®¤è®¢å•å·
            const now = new Date();
            const orderNumber = 'PO' + now.getFullYear() + 
                              String(now.getMonth() + 1).padStart(2, '0') + 
                              String(now.getDate()).padStart(2, '0') + 
                              String(now.getHours()).padStart(2, '0') + 
                              String(now.getMinutes()).padStart(2, '0');
            document.getElementById('orderNumber').value = orderNumber;
            
            // ç¡®ä¿é¢„ç½®æ•°æ®æ˜¾ç¤º
            const firstRow = document.querySelector('.product-table tbody tr:first-child');
            if (firstRow) {
                const inputs = firstRow.querySelectorAll('input');
                if (inputs[0]) inputs[0].value = 'TECH Xéš”çƒ­è†œ';
                if (inputs[1]) inputs[1].value = 'æ™¨æ›¦';
                if (inputs[2]) inputs[2].value = '1.52m*30m';
                if (inputs[3]) inputs[3].value = '799';
            }
            
            // åŠ è½½ä¿å­˜çš„æ•°æ®
            try {
                const savedData = localStorage.getItem('purchaseOrderData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    Object.keys(data).forEach(key => {
                        const input = document.getElementById(key);
                        if (input) {
                            input.value = data[key];
                        }
                    });
                    calculateGrandTotal();
                }
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
            }
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰èœå•
            document.addEventListener('click', function(event) {
                const wrapper = document.querySelector('.document-type-wrapper');
                if (wrapper && !wrapper.contains(event.target)) {
                    const dropdown = document.getElementById('docTypeDropdown');
                    const arrow = document.querySelector('.dropdown-arrow');
                    if (dropdown) dropdown.style.display = 'none';
                    if (arrow) arrow.style.transform = 'rotate(0deg)';
                }
            });
        });

        // é¡µé¢å¸è½½å‰ä¿å­˜æ•°æ®
        window.addEventListener('beforeunload', function() {
            try {
                saveOrder();
            } catch (error) {
                console.error('è‡ªåŠ¨ä¿å­˜å¤±è´¥:', error);
            }
        });
    </script>
</body>
</html>